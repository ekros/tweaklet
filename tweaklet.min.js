let target,scale=1,enabled=!0,selectedElement;const inlineElements=["A","ABBR","ACRONYM","B","BDI","BDO","BIG","BR","BUTTON","CANVAS","CITE","CODE","DATA","DATALIST","DEL","DFN","DEL","DFN","EM","EMBED","I","IFRAME","IMG","INPUT","INS","KBD","LABEL","MAP","MARK","METER","NOSCRIPT","OBJECT","OUTPUT","PICTURE","PROGRESS","Q","RUBY","S","SAMP","SCRIPT","SELECT","SLOT","SMALL","SPAN","STRONG","SUB","SUP","SVG","TEMPLATE","TEXTAREA","TIME","U","TT","VAR","VIDEO","WBR"],actionHistory=[],handleAnchorClick=e=>{e.preventDefault()},handleMouseMove=e=>{target&&(target.style.transform.includes("translate")?target.style.transform=target.style.transform.replace(/translate\(.*\)/,`translate(${e.clientX-target.originalLeft}px, ${e.clientY-target.originalTop}px)`):target.style.transform+=` translate(${e.clientX-target.originalLeft}px, ${e.clientY-target.originalTop}px)`)},handleMouseUp=e=>{document.removeEventListener("mouseup",handleMouseUp),document.removeEventListener("mousemove",handleMouseMove),target&&(target.style.filter="none"),actionHistory.push({target:target,action:"move",value:{left:e.clientX,top:e.clientY}}),target=null},handleMouseDown=e=>{0===e.button&&(e.stopPropagation(),selectedElement&&(selectedElement.style.outline="none"),(selectedElement=e.target).style.outline="2px solid green",(target=e.target).style.filter="blur(1px) grayscale(100%)",document.addEventListener("mousemove",handleMouseMove),document.addEventListener("mouseup",handleMouseUp),actionHistory.push({target:target,action:"move",value:{left:e.target.originalLeft,top:e.target.originalTop}}))},handleMouseLeave=e=>{"black solid 1px"===e.target.style.outline&&(e.target.style.outline="none"),e.target.removeEventListener("mouseleave",handleMouseLeave)},handleMouseOver=e=>{"green solid 2px"!==e.target.style.outline&&(e.target.style.outline="1px solid black"),e.target.addEventListener("mouseleave",handleMouseLeave)},handleDblClick=e=>{e.stopPropagation(),e.target.contentEditable=!0},enableTweaklet=()=>{const e=document.querySelectorAll("*");document.body.style["user-select"]="none",e.forEach(e=>{"A"===e.nodeName&&(e.draggable="false",e.addEventListener("click",handleAnchorClick)),inlineElements.includes(e.nodeName)&&(e.style.display="inline-block");var t=e.getBoundingClientRect();e.style||(e.style={}),e.originalTop=t.top,e.originalLeft=t.left,e.addEventListener("dblclick",handleDblClick),e.addEventListener("mousedown",handleMouseDown),e.addEventListener("mouseover",handleMouseOver)})},disableTweaklet=()=>{const e=document.querySelectorAll("*");document.body.style["user-select"]="auto",e.forEach(e=>{"A"===e.nodeName&&(e.draggable="false",e.removeEventListener("click",handleAnchorClick)),e.removeEventListener("dblclick",handleDblClick),e.removeEventListener("mousedown",handleMouseDown),e.removeEventListener("mouseover",handleMouseOver)})},indicator=document.createElement("div"),instructions=(indicator.style="position:fixed;top:0px;left:50%;background:palegreen;padding:0px 3px;font-size:12px;cursor:pointer",indicator.title="Click to enable/disable",indicator.innerHTML="Tweaklet enabled",document.body.appendChild(indicator),indicator.addEventListener("click",()=>{enabled=enabled?(indicator.style.background="red",indicator.innerHTML="Tweaklet disabled",disableTweaklet(),!1):(indicator.style.background="palegreen",indicator.innerHTML="Tweaklet enabled",enableTweaklet(),!0)}),document.createElement("div"));instructions.style="position:fixed;top:0px;left:55%;background:orange;padding:0px 3px;font-size:14px;cursor:pointer",instructions.innerHTML="?",document.body.appendChild(instructions),instructions.addEventListener("mouseover",()=>{const e=document.createElement("div");e.style="position:fixed;top:20px;left:55%;background:whitesmoke;width:400px;border:1px solid black;z-index: 100;padding:20px;",e.innerHTML=`- Click any element to select<br>
  - Drag any element in the page to change its position<br>
  - Double click: edit text<br>
  - Shift + mouse wheel: resize the element<br>
  - Mouse wheel: bring element forwards/backwards (change z-index)<br>
  - Supr: delete element<br>
  - Ctrl+Z: to undo changes<br>
  `,document.body.appendChild(e),instructions.addEventListener("mouseleave",()=>{e.parentNode?.removeChild(e)})}),document.addEventListener("keydown",e=>{if("z"===e.key&&e.ctrlKey&&0<actionHistory.length){const t=actionHistory.pop();switch(t.action){case"move":t.target.style.transform=`translate(${actionHistory.at(-1).value.left-actionHistory.at(-1).target.originalLeft}px, ${actionHistory.at(-1).value.top-actionHistory.at(-1).target.originalTop}px)`;break;case"edit":t.target.innerHTML=t.value;break;case"scale":t.target.style.transform=t.value;break;case"z-index":t.target.style.zIndex=t.value;break;case"remove":t.parent.appendChild(t.target)}}else"Enter"===e.key&&e.ctrlKey?e.target.contentEditable=!1:"Delete"===e.key?(actionHistory.push({target:selectedElement,action:"remove",parent:selectedElement.parentNode}),selectedElement.remove(),selectedElement=null):"Escape"===e.key?(selectedElement.style.outline="none",selectedElement=null):"Shift"!==e.key&&"Control"!==e.key&&actionHistory.push({target:e.target,action:"edit",value:e.target.innerHTML})}),document.addEventListener("wheel",e=>{selectedElement&&(e.stopPropagation(),0<e.deltaY&&e.shiftKey?(selectedElement.style.transform.includes(`scale(${scale})`)?selectedElement.style.transform=selectedElement.style.transform.replace(`scale(${scale})`,`scale(${scale-.1})`):selectedElement.style.transform+=`scale(${scale-.1})`,scale-=.1,actionHistory.push({target:selectedElement,action:"scale",value:selectedElement.style.transform})):e.deltaY<0&&e.shiftKey?(selectedElement.style.transform.includes(`scale(${scale})`)?selectedElement.style.transform=selectedElement.style.transform.replace(`scale(${scale})`,`scale(${scale+.1})`):selectedElement.style.transform+=`scale(${scale+.1})`,scale+=.1,actionHistory.push({target:selectedElement,action:"scale",value:selectedElement.style.transform})):0<e.deltaY?(selectedElement.style.zIndex=String(Number(selectedElement.style.zIndex)+1),actionHistory.push({target:selectedElement,action:"z-index",value:selectedElement.style.zIndex})):e.deltaY<0&&(selectedElement.style.zIndex=0<=Number(selectedElement.style.zIndex)?String(Number(selectedElement.style.zIndex)-1):"0",actionHistory.push({target:selectedElement,action:"z-index",value:selectedElement.style.zIndex})))}),enableTweaklet();